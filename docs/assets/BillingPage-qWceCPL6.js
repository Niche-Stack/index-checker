import{c as N,j as e,B as V,R as b,S as Y,u as K,f as O,r as l,g as W,A as $,L as Z,C as G,q as J,e as X,d as ee,l as se,o as te,n as ae,m as re,t as R,D as A,T as ce}from"./index-Dk3yE9M2.js";import{P as T}from"./plus-circle-D8pnaDqQ.js";import{f as ie}from"./format-B2FXVs-x.js";import{C as F}from"./check-circle-DBWNtD4N.js";import{D as le}from"./download-BrZKwp0s.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=N("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=N("MinusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=N("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),oe=({package:a,isSelected:n,onSelect:h})=>e.jsxs("div",{className:`
        border rounded-lg p-5 cursor-pointer transition-all hover:shadow-md
        ${n?"border-blue-800 bg-blue-50 shadow-sm":"border-slate-200 bg-white hover:border-slate-300"}
      `,onClick:h,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-md flex items-center justify-center",children:e.jsx(me,{className:"w-5 h-5 text-blue-800"})}),n&&e.jsx("div",{className:"w-6 h-6 bg-blue-800 rounded-full flex items-center justify-center",children:e.jsx(V,{className:"w-4 h-4 text-white"})})]}),e.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:a.name}),e.jsxs("p",{className:"text-blue-800 font-bold text-xl mb-1",children:["$",a.price]}),e.jsxs("p",{className:"text-sm text-slate-500 mb-2",children:[a.credits.toLocaleString()," credits"]}),e.jsxs("p",{className:"text-xs text-slate-600",children:["$",(a.price/a.credits).toFixed(4)," per credit"]}),e.jsx("div",{className:"mt-3 text-sm text-slate-700",children:a.description})]}),xe=({transactions:a,loading:n,creditPackages:h})=>{if(n)return e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(b,{className:"w-6 h-6 text-blue-800 animate-spin mx-auto mb-3"}),e.jsx("p",{children:"Loading transactions..."})]});if(a.length===0)return e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-slate-100 mb-4",children:e.jsx(Y,{className:"w-6 h-6 text-slate-400"})}),e.jsx("h3",{className:"text-lg font-medium text-slate-800 mb-2",children:"No transactions yet"}),e.jsx("p",{className:"text-slate-500",children:"Purchase credits or use the service to see your transaction history"})]});const m=t=>{const p=h.find(j=>j.id===t);return p?p.name:"Unknown Package"};return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50",children:[e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider px-6 py-3",children:"Date"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider px-6 py-3",children:"Transaction"}),e.jsx("th",{className:"text-left text-xs font-medium text-slate-500 uppercase tracking-wider px-6 py-3",children:"Type"}),e.jsx("th",{className:"text-right text-xs font-medium text-slate-500 uppercase tracking-wider px-6 py-3",children:"Amount"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:a.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-700",children:t.timestamp&&ie(t.timestamp.toDate(),"MMM d, yyyy h:mm a")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`
                    w-8 h-8 rounded-full flex items-center justify-center mr-3
                    ${t.type==="purchase"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}
                  `,children:t.type==="purchase"?e.jsx(T,{className:"w-4 h-4"}):e.jsx(ne,{className:"w-4 h-4"})}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-medium text-slate-900",children:t.type==="purchase"?`Credit Purchase - ${m(t.packageId||"")}`:`Credit Usage - ${t.reason||"Service Usage"}`})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`
                  inline-flex rounded-full text-xs font-medium px-2.5 py-0.5
                  ${t.type==="purchase"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}
                `,children:t.type==="purchase"?"Purchase":"Usage"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:[e.jsxs("span",{className:`text-sm font-medium ${t.type==="purchase"?"text-green-700":"text-blue-700"}`,children:[t.type==="purchase"?"+":"",t.credits," credits"]}),t.amount&&e.jsx("p",{className:"text-xs text-slate-500",children:t.type==="purchase"?"$"+t.amount.toFixed(2):""})]})]},t.id))})]})})},ye=()=>{var S,D;const{currentUser:a}=K(),{credits:n,getCreditPackages:h}=O(),[m,t]=l.useState([]),[p,j]=l.useState([]),[o,v]=l.useState(""),[x,w]=l.useState(1),[E,k]=l.useState(!0),[P,u]=l.useState(!1),[C,_]=l.useState(""),[I,d]=l.useState("");l.useEffect(()=>{if(!a)return;(async()=>{k(!0);try{const r=await h();t(r);const y=J(X(ee,"creditTransactions"),se("userId","==",a.uid),te("timestamp","desc"),ae(10)),i=(await re(y)).docs.map(f=>({id:f.id,...f.data()}));j(i)}catch(r){console.error("Error fetching billing data:",r)}finally{k(!1)}})()},[a,h]);const U=async()=>{if(!o||!a){d("Please select a package.");return}const s=m.find(r=>r.id===o);if(!s){d("Selected package details not found.");return}u(!0),d(""),_("");try{const r=R(A,"create_razorpay_order"),y={amount:s.price*x,currency:"USD",packageId:s.id,packageName:s.name},i=(await r(y)).data;if(!i.success||!i.orderId)throw new Error(i.message||"Failed to create Razorpay order.");const f={key:i.razorpayKeyId,amount:i.amount,currency:i.currency,name:"Index Checker",description:`Purchase ${s.name}`,order_id:i.orderId,handler:async c=>{try{const g=R(A,"verify_razorpay_payment"),L={razorpay_payment_id:c.razorpay_payment_id,razorpay_order_id:c.razorpay_order_id,razorpay_signature:c.razorpay_signature,packageId:s.id,creditsToAdd:s.credits*x,amountPaid:s.price*x},M=(await g(L)).data;if(M.success){_("Credits purchased successfully! Your balance will update shortly.");const B={id:c.razorpay_payment_id,userId:a.uid,packageId:o,credits:s.credits*x,amount:s.price*x,currency:"USD",paymentId:c.razorpay_payment_id,orderId:c.razorpay_order_id,timestamp:ce.now(),type:"purchase",reason:`Purchased ${s.name}`};j(Q=>[B,...Q.filter(H=>!H.id.startsWith("temp-"))]),v(""),w(1)}else d(M.message||"Payment verification failed.")}catch(g){console.error("Error verifying payment:",g),d(g.message||"An error occurred during payment verification.")}finally{u(!1)}},prefill:{name:a.displayName||"",email:a.email||""},notes:{userId:a.uid,packageId:s.id},theme:{color:"#3B82F6"},modal:{ondismiss:()=>{u(!1),d("Payment was cancelled.")}}},z=new window.Razorpay(f);z.on("payment.failed",function(c){console.error("Razorpay payment failed:",c.error),d(`Payment Failed: ${c.error.description} (Reason: ${c.error.reason})`),u(!1)}),z.open()}catch(r){console.error("Error purchasing credits:",r),d(r.message||"An error occurred during the purchase process."),u(!1)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Billing & Credits"}),e.jsx("p",{className:"text-slate-500",children:"Manage your credit balance and billing information"})]}),e.jsxs("div",{className:"mt-4 md:mt-0 bg-slate-100 rounded-full px-4 py-2 flex items-center",children:[e.jsx(W,{className:"w-5 h-5 text-blue-800 mr-2"}),e.jsxs("span",{className:"font-medium text-slate-800",children:[n," credits available"]})]})]}),C&&e.jsxs("div",{className:"bg-green-50 border border-green-100 text-green-800 rounded-lg p-4 mb-6 flex items-center",children:[e.jsx(F,{className:"w-5 h-5 mr-2 text-green-600"}),C]}),I&&e.jsxs("div",{className:"bg-red-50 border border-red-100 text-red-800 rounded-lg p-4 mb-6 flex items-center",children:[e.jsx($,{className:"w-5 h-5 mr-2 text-red-600"}),I]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-6 border-b border-slate-100",children:e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Purchase Credits"})}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-slate-600 mb-6",children:"Choose a credit package below. Credits are used for checking indexing status (1 credit per page) and requesting indexing (5 credits per page)."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:m.map(s=>e.jsx(oe,{package:s,isSelected:o===s.id,onSelect:()=>v(s.id)},s.id))}),o&&e.jsx("div",{className:"bg-slate-50 p-4 rounded-lg mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"mb-4 md:mb-0",children:[e.jsx("h3",{className:"font-medium text-slate-800 mb-1",children:"Purchase Details"}),e.jsxs("p",{className:"text-sm text-slate-600",children:[(S=m.find(s=>s.id===o))==null?void 0:S.name," Package"]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"quantity",className:"block text-sm text-slate-600 mb-1",children:"Quantity"}),e.jsx("select",{id:"quantity",value:x,onChange:s=>w(parseInt(s.target.value)),className:"input",children:[1,2,3,4,5].map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Price"}),e.jsxs("p",{className:"font-bold text-slate-900",children:["$",(((D=m.find(s=>s.id===o))==null?void 0:D.price)||0)*x]})]}),e.jsx("button",{onClick:U,disabled:P,className:"btn-primary h-10",children:P?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Buy Now"]})})]})]})}),e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(de,{className:"w-5 h-5 text-blue-800 mr-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-800 mb-1",children:"Volume Discounts Available"}),e.jsxs("p",{className:"text-sm text-blue-700",children:["For custom packages or volume discounts on larger credit purchases, please",e.jsx("a",{href:"mailto:support@indexchecker.ai",className:"font-medium underline ml-1",children:"contact our team"}),"."]})]})]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Transaction History"}),e.jsxs("button",{className:"text-sm text-blue-800 hover:text-blue-900 flex items-center",children:[e.jsx(le,{className:"w-4 h-4 mr-1"}),"Export"]})]}),e.jsx(xe,{transactions:p,loading:E,creditPackages:m})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-6 border-b border-slate-100",children:e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Credit Usage"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center mr-3",children:e.jsx(F,{className:"w-4 h-4 text-blue-800"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-slate-800",children:"Checking Pages"}),e.jsx("p",{className:"text-sm text-slate-600",children:"1 credit per page checked"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center mr-3",children:e.jsx(b,{className:"w-4 h-4 text-green-700"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-slate-800",children:"Requesting Indexing"}),e.jsx("p",{className:"text-sm text-slate-600",children:"5 credits per indexing request"})]})]})]}),n<50&&e.jsxs("div",{className:"mt-6 p-3 bg-amber-50 text-amber-800 rounded-lg flex items-center",children:[e.jsx($,{className:"w-4 h-4 mr-2 text-amber-600"}),e.jsx("span",{className:"text-sm",children:"Your credit balance is running low"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-6 border-b border-slate-100",children:e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Billing FAQ"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-slate-800 mb-1",children:"Do credits expire?"}),e.jsx("p",{className:"text-sm text-slate-600",children:"No, your purchased credits never expire."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-slate-800 mb-1",children:"Can I get a refund?"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Unused credits can be refunded within 30 days of purchase."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-slate-800 mb-1",children:"Are there any hidden fees?"}),e.jsx("p",{className:"text-sm text-slate-600",children:"No, you only pay for the credits you purchase."})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(Z,{to:"/settings",className:"text-blue-800 text-sm flex items-center hover:text-blue-900",children:["More billing questions",e.jsx(G,{className:"w-4 h-4 ml-1"})]})})]})]})]})]})]})};export{ye as default};
